<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<title data-react-helmet="true">Compute Distances | Smart Data Lake Builder</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://www.smartdatalake.ch/docs/getting-started/part-1/compute-distances"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Compute Distances | Smart Data Lake Builder"><meta data-react-helmet="true" name="description" content="Goal"><meta data-react-helmet="true" property="og:description" content="Goal"><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://www.smartdatalake.ch/docs/getting-started/part-1/compute-distances"><link data-react-helmet="true" rel="alternate" href="https://www.smartdatalake.ch/docs/getting-started/part-1/compute-distances" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://www.smartdatalake.ch/docs/getting-started/part-1/compute-distances" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.f0e4dc4d.css">
<link rel="preload" href="/assets/js/runtime~main.f2fe6023.js" as="script">
<link rel="preload" href="/assets/js/main.33d7ec33.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/sdl_logo.png" alt="Smart Data Lake Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/sdl_logo.png" alt="Smart Data Lake Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Smart Data Lake</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/smart-data-lake/smart-data-lake" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_Pssr toggle_TdHA toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">🌜</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">🌞</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/">Smart Data Lake</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_VCh3" aria-current="page" href="/docs/getting-started/setup">Getting Started</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/setup">Technical Setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/get-input-data">Inputs</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_VCh3" aria-current="page" tabindex="0" href="/docs/getting-started/part-1/get-departures">Part 1</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/part-1/get-departures">Get Departures</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/part-1/get-airports">Get Airports</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/part-1/select-columns">Select Columns</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/part-1/joining-it-together">Joining It Together</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/part-1/joining-departures-and-arrivals">Get Departure Coordinates</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/getting-started/part-1/compute-distances">Compute Distances</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/docs/getting-started/part-2/industrializing">Part 2</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/docs/getting-started/part-3/custom-webservice">Part 3</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" tabindex="0" href="/docs/getting-started/troubleshooting/common-problems">Troubleshooting</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/reference/build">Reference</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/JsonSchemaViewer">Configuration Schema Viewer</a></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Compute Distances</h1></header><h2 class="anchor anchorWithStickyNavbar_mojV" id="goal">Goal<a class="hash-link" href="#goal" title="Direct link to heading">​</a></h2><p>In this part, we will compute the distances between departure and arrival airports
so that our railway enthusiast Tom can see which planes could be replaced by rail traffic.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="define-output-object">Define output object<a class="hash-link" href="#define-output-object" title="Direct link to heading">​</a></h2><p>Let&#x27;s define our final output object for this part:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">  btl-distances {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    type = CsvFileDataObject</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    path = &quot;~{id}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="define-compute_distances-action">Define compute_distances action<a class="hash-link" href="#define-compute_distances-action" title="Direct link to heading">​</a></h2><p>How do we compute the distances ?
The answer is in the file <em>src/main/scala/com/sample/ComputeDistanceTransformer.scala</em>.</p><p>So far, we only used SQL transformers.
But more complex transformations can be written in custom code and referenced in the config.
This gives you great flexibility for cases with specific business logic, such as this one.</p><p>We have one input and one output: therefore our custom class is a <em>CustomDfTransformer</em> (instead of CustomDf<strong>s</strong>Transformer).
It takes the input dataframe <em>df</em> and calls a User Defined Function called <em>calculateDistanceInKilometerUdf</em>
to do the computation.
It expects the column names dep_latitude_deg, dep_longitude_deg, arr_latitude_deg and arr_longitude_deg in the input.
This matches the column names we used in the SQL-Code in the last-step.</p><p>We won&#x27;t go into the details of the Udf.
You can follow this <a href="https://stackoverflow.com/questions/27928/calculate-distance-between-two-latitude-longitude-points-haversine-formula" target="_blank" rel="noopener noreferrer">stackoverflow link</a>
if you want to learn more.</p><p>Finally, the transformation writes the result into a column called distance.
It also adds a column <em>could_be_done_by_rail</em> to the output that simply checks if the distance is smaller than 500 km.</p><p>In order to wire this CustomTransformation into our config, we add the following action:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">  compute-distances {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    type = CopyAction</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inputId = btl-departures-arrivals-airports</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    outputId = btl-distances</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    transformers = [{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      type = ScalaClassDfTransformer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      className = com.sample.ComputeDistanceTransformer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    metadata {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      feed = compute</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>We used a CopyAction and told it to execute the code in the class <em>com.sample.ComputeDistanceTransformer</em> to transform the data.
We could also have used a CustomSparkAction like in the previous step,
but this would have resulted in more complex code working with lists of inputs, outputs and transformers.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="try-it-out">Try it out<a class="hash-link" href="#try-it-out" title="Direct link to heading">​</a></h2><p><a target="_blank" href="/assets/files/application-part1-compute-final-fcc8c1494d45a8500eedd508e0245aff.conf">This</a> is how the final config-file looks like.</p><p>To use the Java Code in our sdl-spark docker image, we have to compile it.
You have already done this in the <a href="/docs/getting-started/setup">setup</a>, but lets review this step again. It can be done by using a maven docker image as follows</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir .mvnrepo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker run -v ${PWD}:/mnt/project -v ${PWD}/.mvnrepo:/mnt/.mvnrepo maven:3.6.0-jdk-11-slim -- mvn -f /mnt/project/pom.xml &quot;-Dmaven.repo.local=/mnt/.mvnrepo&quot; package</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>or you can also use maven directly if you have Java SDK and Maven installed</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">mvn package</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This creates a jar-file ./target/getting-started-1.0.jar containing the compiled Scala classes.
The <em>docker run</em> includes a parameter to mount ./target into the docker image, which makes this jar-file accessible to SDL.</p><p>Now you can start SDL again:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">docker run --rm -v ${PWD}/data:/mnt/data -v ${PWD}/target:/mnt/lib -v ${PWD}/config:/mnt/config sdl-spark:latest -c /mnt/config --feed-sel compute</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Under <em>data/btl-distances</em> you can now see the final result. </p><h3 class="anchor anchorWithStickyNavbar_mojV" id="the-execution-dag-of-the-compute-feed">The Execution DAG of the compute feed<a class="hash-link" href="#the-execution-dag-of-the-compute-feed" title="Direct link to heading">​</a></h3><p>In the console, you probably started noticing some pretty ASCII Art that looks like this:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">                     ┌─────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     │start│</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     └┬──┬─┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      │  └───────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      v                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ┌─────────────────────────────────────────┐ │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> │select-airport-cols SUCCEEDED PT4.421793S│ │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> └───────────────┬─────────────────────────┘ │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 │                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 v                           v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ┌──────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> │join_departures_airports SUCCEEDED PT2.938995S│</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> └──────────────────────┬───────────────────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ┌────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   │compute_distances SUCCEEDED PT1.160045S│</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   └────────────────────────────────────────┘</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This is the Execution <em>DAG</em> of our data pipeline.
SDL internally builds a Directed Acyclic Graph (DAG) to analyze all dependencies between your actions.
Because it&#x27;s acyclic, it cannot have loops, so it&#x27;s impossible to define an action that depends on an output of subsequent actions.
SDL uses this DAG to optimize execution of your pipeline as it knows in which order the pipeline needs to execute.</p><p>What you see in the logs, is a representation of what the SDL has determined as dependencies.
If you don&#x27;t get the results you expect, it&#x27;s good to check if the DAG looks correct.
At the end you will also see the graph again with status indicators (SUCCEEDED, CANCELLED, ...) and the duration it took to execute the action.</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Hold on</h5></div><div class="admonition-content"><p>It&#x27;s worth pausing at this point to appreciate this fact:<br>
<!-- -->You didn&#x27;t have to explicitly tell SDL how to execute your actions.
You also didn&#x27;t have to define the dependencies between your actions.
Just from the definitions of DataObjects and Actions alone, SDL builds a DAG and knows what needs to be executed and how.</p></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="the-execution-dag-of-the--feed">The Execution DAG of the .* feed<a class="hash-link" href="#the-execution-dag-of-the--feed" title="Direct link to heading">​</a></h3><p>You can also execute the entire data pipeline by selecting all feeds:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">docker run --rm -v ${PWD}/data:/mnt/data -v ${PWD}/target:/mnt/lib -v ${PWD}/config:/mnt/config sdl-spark:latest --config /mnt/config --feed-sel .*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>The successful execution DAG looks like this</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">                                        ┌─────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                        │start│</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                        └─┬─┬─┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                          │ │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                          │ └─────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                          v                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               ┌───────────────────────────────────────┐          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               │download-airports SUCCEEDED PT8.662886S│          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               └──────┬────────────────────────────────┘          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      │                                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      v                                           v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ┌─────────────────────────────────────────┐ ┌─────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> │select-airport-cols SUCCEEDED PT4.629163S│ │download-departures SUCCEEDED PT0.564972S│</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> └─────────────────────────────────────────┘ └─────────────────────────────────────────┘                                      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                    v               v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    ┌──────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    │join_departures_airports SUCCEEDED PT4.453514S│</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    └──────────────────────┬───────────────────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                           v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                       ┌───────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                       │compute_distances SUCCEEDED PT1.404391S│</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                       └───────────────────────────────────────┘</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>SDL was able to determine that download-airports and download-departures can be executed in parallel,
independently from each other. It&#x27;s only at join-departures-airports and beyond that both Data Sources are needed.</p><p>SDL has command-line option called --parallelism which allows you to set the degree of parallelism used when executing the DAG run.
Per default, it&#x27;s set to 1.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="the-execution-dag-of-the-failed--feed">The Execution DAG of the failed .* feed<a class="hash-link" href="#the-execution-dag-of-the-failed--feed" title="Direct link to heading">​</a></h3><p>If you set the option <em>readTimeoutMs=0</em> in the DataObject <em>ext-departures</em>  it&#x27;s possible that the <em>download-departures</em> action fails.
That&#x27;s because SDL abandons the download because the REST-Service is too slow to respond.
If that happens, the DAG will look like this:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">21/09/14 09:05:36 ERROR ActionDAGRun: Exec: TaskFailedException: Task download-departures failed. Root cause is &#x27;WebserviceException: connect timed out&#x27;: WebserviceException: connect timed out</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">21/09/14 09:05:36 INFO ActionDAGRun$: Exec FAILED for .* runId=1 attemptId=1:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                       ┌─────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                       │start│</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                       └─┬─┬─┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                         │ │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                         │ └─────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                         v                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              ┌───────────────────────────────────────┐          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              │download-airports SUCCEEDED PT6.638844S│          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              └───────┬───────────────────────────────┘          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      │                                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      v                                          v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ┌─────────────────────────────────────────┐ ┌──────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> │select-airport-cols SUCCEEDED PT3.064118S│ │download-departures FAILED PT1.084153S│</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> └──────────────────────────────────┬──────┘ └──┬───────────────────────────────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                    │           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                    v           v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        ┌──────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        │join-departures-airports CANCELLED│</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        └─────────────────┬────────────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                          v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            ┌───────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            │compute-distances CANCELLED│</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            └───────────────────────────┘</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>As you can see, in this example, the action <em>download-departures</em> failed because of a timeout.
Because SDL determined that both downloads are independent, it was able to complete <em>select-airport-cols</em> succesfully.</p><p>As explained in <a href="/docs/getting-started/part-1/select-columns#more-on-feeds">a previous step of the guide</a>,
if your download fails you will have to re-execute the download feed before being able to execute
.* again.</p><p><strong>Congratulations!</strong><br>
<!-- -->You successfully recreated the configuration file that is contained in the Docker Image you ran in the first step.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/smart-data-lake/smart-data-lake/tree/documentation/docs/getting-started/part-1/compute-distances.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/getting-started/part-1/joining-departures-and-arrivals"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Get Departure Coordinates</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/getting-started/part-2/industrializing"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Industrializing our data pipeline</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#goal" class="table-of-contents__link toc-highlight">Goal</a></li><li><a href="#define-output-object" class="table-of-contents__link toc-highlight">Define output object</a></li><li><a href="#define-compute_distances-action" class="table-of-contents__link toc-highlight">Define compute_distances action</a></li><li><a href="#try-it-out" class="table-of-contents__link toc-highlight">Try it out</a><ul><li><a href="#the-execution-dag-of-the-compute-feed" class="table-of-contents__link toc-highlight">The Execution DAG of the compute feed</a></li><li><a href="#the-execution-dag-of-the--feed" class="table-of-contents__link toc-highlight">The Execution DAG of the .* feed</a></li><li><a href="#the-execution-dag-of-the-failed--feed" class="table-of-contents__link toc-highlight">The Execution DAG of the failed .* feed</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/">Getting started</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/smart-data-lake/smart-data-lake" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/smart-data-lake/smart-data-lake/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub Issues<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://www.elca.ch" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>ELCA<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Smart Data Lake, Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.f2fe6023.js"></script>
<script src="/assets/js/main.33d7ec33.js"></script>
</body>
</html>