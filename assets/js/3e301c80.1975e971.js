"use strict";(self.webpackChunksmart_data_lake=self.webpackChunksmart_data_lake||[]).push([[3422],{7356:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>l});var i=t(4848),o=t(8453);const a={id:"agents",title:"Agents (Experimental)"},s=void 0,r={id:"reference/agents",title:"Agents (Experimental)",description:"This feature is Experimental",source:"@site/docs/reference/agents.md",sourceDirName:"reference",slug:"/reference/agents",permalink:"/docs/reference/agents",draft:!1,unlisted:!1,editUrl:"https://github.com/smart-data-lake/smart-data-lake/tree/documentation/docs/reference/agents.md",tags:[],version:"current",frontMatter:{id:"agents",title:"Agents (Experimental)"},sidebar:"tutorialSidebar",previous:{title:"Transformations",permalink:"/docs/reference/transformations"},next:{title:"Streaming",permalink:"/docs/reference/streaming"}},c={},l=[{value:"Introduction",id:"introduction",level:2},{value:"Agent Config",id:"agent-config",level:2},{value:"Agents Types",id:"agents-types",level:2},{value:"Limitations",id:"limitations",level:2}];function d(e){const n={admonition:"admonition",code:"code",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsx)(n.p,{children:"This feature is Experimental"})}),"\n",(0,i.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,i.jsx)(n.p,{children:"The Agent feature allows to have a main instance of SDLB sending instructions to another Instance of SDLB, called the Remote Agent.\r\nThis Remote Agent then executes the action in its environment and returns the schema of the resulting data in an empty SparkSubFeed.\r\nOnly metadata is sent over the connection between Remote Agent and Main Instance.\r\nThe Main Instance then fetches the result if needed using its own connection to the Data."}),"\n",(0,i.jsx)(n.p,{children:"A possible workflow using Azure Relay Service (which will be used in the example below) is illustrated in the following figure:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Image",src:t(1744).A+"",width:"731",height:"845"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"SDLB Main instance is started (either ad hoc or by a scheduler) and wants to execute an Action for which agentId is specified"}),"\n",(0,i.jsx)(n.li,{children:"Main Instance wants to send instructions to remote Agent. It connects to Azure Relay Service"}),"\n",(0,i.jsx)(n.li,{children:"SDLB Agent reveives instructions"}),"\n",(0,i.jsx)(n.li,{children:"SDLB Agent executes Action remotely. Goal of the action: Copy from On-Premise Data-Source to cloud. Get data from On-Premise Data-Source"}),"\n",(0,i.jsx)(n.li,{children:"SDLB Agent executes Action remotely: Copy Data to the Cloud via On-Premise connection"}),"\n",(0,i.jsx)(n.li,{children:"SDLB Agent finished execution Action and sends back schema of output DataObject"}),"\n",(0,i.jsx)(n.li,{children:"SDLB Main Instance reveives schema of output DataObject"}),"\n",(0,i.jsx)(n.li,{children:"SDLB Main Instance accesses Data of DataObject from Cloud connection"}),"\n",(0,i.jsx)(n.li,{children:"SDLB Main Instance executes the next Action, which uses the Data from Cloud Staging and stores results in Cloud Storage"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"agent-config",children:"Agent Config"}),"\n",(0,i.jsx)(n.p,{children:"To use this feature, you must define a section called agents in your HOCON config.\r\nThis config section allows to describe how to reach your remote agents as well as the connections that the remote agents have."}),"\n",(0,i.jsx)(n.p,{children:"Example: Agents section defining a JettyAgent along with a private Connection that only the Agent can access."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'agents {\r\n  agent-dummy {\r\n    type = JettyAgent\r\n    url = "ws://localhost:4441/ws/"\r\n    connections {\r\n      remoteFile {\r\n        id = remoteFile\r\n        type = HadoopFileConnection\r\n        pathPrefix = "target/jetty_agent_dummy_connection"\r\n      }\r\n    }\r\n  }\r\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Once you have defined your agents, you can reference them in your actions by specifying the field agentId.\r\nIn the example above the agentId would be ",(0,i.jsx)(n.strong,{children:"agent-dummy"}),".\r\nIf you define an agentId in your action, it will be executed on that agent."]}),"\n",(0,i.jsx)(n.p,{children:"More precisely, the Main Instance will send instructions on how to execute the action on the Remote Agent.\r\nThese instructions take the form of a string containing all the necessary hocon configuration required to execute the Action.\r\nThe instructions contain the Action's config along with all Input and Output DataObjects of the action.\r\nThat's all that the Agent knows, it does not get any other context when it is started."}),"\n",(0,i.jsxs)(n.p,{children:["Usually, some of these DataObjects will be linked to connections that are only available on the instance where the Agent lives, for example, a private Database Connection so that the Remote Agent can fetch Data for a DataObject.\r\nConnections defined in the agents section ",(0,i.jsx)(n.strong,{children:"override"})," connections defined in the global connections section when they are executed on the Agent.\r\nWhen the Agent is deployed, it gets the necessary authentication information for these agent connections on startup on the Remote Instance and then just waits for instructions."]}),"\n",(0,i.jsx)(n.h2,{id:"agents-types",children:"Agents Types"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Simple, unsecured Jetty Websocket for development use"}),"\n",(0,i.jsx)(n.li,{children:"Azure Relay service (requires sdl-azure and an Azure subscription with a Relay that has a Hybrid Connection). The traffic between the Agent and the Remote Instance in protected by AzureRelayService. The main instance needs to know a SharedAccessKey in order to connect to the Remote Agent via the AzureRelay."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"limitations",children:"Limitations"}),"\n",(0,i.jsx)(n.p,{children:"Only DataObjects that return SparkSubfeeds are currently supported."})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},1744:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/agents-example-2380671f30821d4c6340189345cefb95.png"},8453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>r});var i=t(6540);const o={},a=i.createContext(o);function s(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);