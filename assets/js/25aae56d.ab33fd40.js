"use strict";(self.webpackChunksmart_data_lake=self.webpackChunksmart_data_lake||[]).push([[9880],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return m}});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),p=c(n),m=o,f=p["".concat(s,".").concat(m)]||p[m]||d[m]||r;return n?a.createElement(f,i(i({ref:t},u),{},{components:n})):a.createElement(f,i({ref:t},u))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,i=new Array(r);i[0]=p;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var c=2;c<r;c++)i[c]=n[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},8215:function(e,t,n){var a=n(7294);t.Z=function(e){var t=e.children,n=e.hidden,o=e.className;return a.createElement("div",{role:"tabpanel",hidden:n,className:o},t)}},9877:function(e,t,n){n.d(t,{Z:function(){return u}});var a=n(7462),o=n(7294),r=n(2389),i=n(9548),l=n(6010),s="tabItem_LplD";function c(e){var t,n,r,c=e.lazy,u=e.block,d=e.defaultValue,p=e.values,m=e.groupId,f=e.className,h=o.Children.map(e.children,(function(e){if((0,o.isValidElement)(e)&&void 0!==e.props.value)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),v=null!=p?p:h.map((function(e){var t=e.props;return{value:t.value,label:t.label,attributes:t.attributes}})),k=(0,i.lx)(v,(function(e,t){return e.value===t.value}));if(k.length>0)throw new Error('Docusaurus error: Duplicate values "'+k.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var g=null===d?d:null!=(t=null!=d?d:null==(n=h.find((function(e){return e.props.default})))?void 0:n.props.value)?t:null==(r=h[0])?void 0:r.props.value;if(null!==g&&!v.some((function(e){return e.value===g})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+g+'" but none of its children has the corresponding value. Available values are: '+v.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var b=(0,i.UB)(),D=b.tabGroupChoices,y=b.setTabGroupChoices,w=(0,o.useState)(g),E=w[0],T=w[1],x=[],N=(0,i.o5)().blockElementScrollPositionUntilNextRender;if(null!=m){var C=D[m];null!=C&&C!==E&&v.some((function(e){return e.value===C}))&&T(C)}var S=function(e){var t=e.currentTarget,n=x.indexOf(t),a=v[n].value;a!==E&&(N(t),T(a),null!=m&&y(m,a))},j=function(e){var t,n=null;switch(e.key){case"ArrowRight":var a=x.indexOf(e.currentTarget)+1;n=x[a]||x[0];break;case"ArrowLeft":var o=x.indexOf(e.currentTarget)-1;n=x[o]||x[x.length-1]}null==(t=n)||t.focus()};return o.createElement("div",{className:"tabs-container"},o.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,l.Z)("tabs",{"tabs--block":u},f)},v.map((function(e){var t=e.value,n=e.label,r=e.attributes;return o.createElement("li",(0,a.Z)({role:"tab",tabIndex:E===t?0:-1,"aria-selected":E===t,key:t,ref:function(e){return x.push(e)},onKeyDown:j,onFocus:S,onClick:S},r,{className:(0,l.Z)("tabs__item",s,null==r?void 0:r.className,{"tabs__item--active":E===t})}),null!=n?n:t)}))),c?(0,o.cloneElement)(h.filter((function(e){return e.props.value===E}))[0],{className:"margin-vert--md"}):o.createElement("div",{className:"margin-vert--md"},h.map((function(e,t){return(0,o.cloneElement)(e,{key:t,hidden:e.props.value!==E})}))))}function u(e){var t=(0,r.Z)();return o.createElement(c,(0,a.Z)({key:String(t)},e))}},9281:function(e,t,n){n.r(t),n.d(t,{contentTitle:function(){return u},default:function(){return f},frontMatter:function(){return c},metadata:function(){return d},toc:function(){return p}});var a=n(7462),o=n(3366),r=(n(7294),n(3905)),i=n(9877),l=n(8215),s=["components"],c={title:"Compute Distances"},u=void 0,d={unversionedId:"getting-started/part-1/compute-distances",id:"getting-started/part-1/compute-distances",title:"Compute Distances",description:"Goal",source:"@site/docs/getting-started/part-1/compute-distances.md",sourceDirName:"getting-started/part-1",slug:"/getting-started/part-1/compute-distances",permalink:"/docs/getting-started/part-1/compute-distances",editUrl:"https://github.com/smart-data-lake/smart-data-lake/tree/documentation/docs/getting-started/part-1/compute-distances.md",tags:[],version:"current",frontMatter:{title:"Compute Distances"},sidebar:"docs",previous:{title:"Get Departure Coordinates",permalink:"/docs/getting-started/part-1/joining-departures-and-arrivals"},next:{title:"Industrializing our data pipeline",permalink:"/docs/getting-started/part-2/industrializing"}},p=[{value:"Goal",id:"goal",children:[],level:2},{value:"Define output object",id:"define-output-object",children:[],level:2},{value:"Define compute_distances action",id:"define-compute_distances-action",children:[],level:2},{value:"Try it out",id:"try-it-out",children:[{value:"The Execution DAG of the compute feed",id:"the-execution-dag-of-the-compute-feed",children:[],level:3},{value:"The Execution DAG of the .* feed",id:"the-execution-dag-of-the--feed",children:[],level:3},{value:"The Execution DAG of the failed .* feed",id:"the-execution-dag-of-the-failed--feed",children:[],level:3}],level:2}],m={toc:p};function f(e){var t=e.components,c=(0,o.Z)(e,s);return(0,r.kt)("wrapper",(0,a.Z)({},m,c,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"goal"},"Goal"),(0,r.kt)("p",null,"In this part, we will compute the distances between departure and arrival airports\nso that our railway enthusiast Tom can see which planes could be replaced by rail traffic."),(0,r.kt)("h2",{id:"define-output-object"},"Define output object"),(0,r.kt)("p",null,"Let's define our final output object for this part:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'  btl-distances {\n    type = CsvFileDataObject\n    path = "~{id}"\n  }\n')),(0,r.kt)("h2",{id:"define-compute_distances-action"},"Define compute_distances action"),(0,r.kt)("p",null,"How do we compute the distances ?\nThe answer is in the file ",(0,r.kt)("em",{parentName:"p"},"src/main/scala/com/sample/ComputeDistanceTransformer.scala"),"."),(0,r.kt)("p",null,"So far, we only used SQL transformers.\nBut more complex transformations can be written in custom code and referenced in the config.\nThis gives you great flexibility for cases with specific business logic, such as this one."),(0,r.kt)("p",null,"We have one input and one output: therefore our custom class is a ",(0,r.kt)("em",{parentName:"p"},"CustomDfTransformer")," (instead of CustomDf",(0,r.kt)("strong",{parentName:"p"},"s"),"Transformer).\nIt takes the input dataframe ",(0,r.kt)("em",{parentName:"p"},"df")," and calls a User Defined Function called ",(0,r.kt)("em",{parentName:"p"},"calculateDistanceInKilometerUdf"),"\nto do the computation.\nIt expects the column names dep_latitude_deg, dep_longitude_deg, arr_latitude_deg and arr_longitude_deg in the input.\nThis matches the column names we used in the SQL-Code in the last-step."),(0,r.kt)("p",null,"We won't go into the details of the Udf.\nYou can follow this ",(0,r.kt)("a",{parentName:"p",href:"https://stackoverflow.com/questions/27928/calculate-distance-between-two-latitude-longitude-points-haversine-formula"},"stackoverflow link"),"\nif you want to learn more."),(0,r.kt)("p",null,"Finally, the transformation writes the result into a column called distance.\nIt also adds a column ",(0,r.kt)("em",{parentName:"p"},"could_be_done_by_rail")," to the output that simply checks if the distance is smaller than 500 km."),(0,r.kt)("p",null,"In order to wire this CustomTransformation into our config, we add the following action:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"  compute-distances {\n    type = CopyAction\n    inputId = btl-departures-arrivals-airports\n    outputId = btl-distances\n    transformers = [{\n      type = ScalaClassDfTransformer\n      className = com.sample.ComputeDistanceTransformer\n    }]\n    metadata {\n      feed = compute\n    }\n  }\n")),(0,r.kt)("p",null,"We used a CopyAction and told it to execute the code in the class ",(0,r.kt)("em",{parentName:"p"},"com.sample.ComputeDistanceTransformer")," to transform the data.\nWe could also have used a CustomSparkAction like in the previous step,\nbut this would have resulted in more complex code working with lists of inputs, outputs and transformers."),(0,r.kt)("h2",{id:"try-it-out"},"Try it out"),(0,r.kt)("p",null,(0,r.kt)("a",{target:"_blank",href:n(1159).Z},"This")," is how the final config-file looks like."),(0,r.kt)("p",null,"To use the Java Code in our sdl-spark docker image, we have to compile it.\nYou have already done this in the ",(0,r.kt)("a",{parentName:"p",href:"/docs/getting-started/setup"},"setup"),", but lets review this step again. It can be done by using a maven docker image as follows"),(0,r.kt)(i.Z,{groupId:"docker-podman-switch",defaultValue:"docker",values:[{label:"Docker",value:"docker"},{label:"Podman",value:"podman"}],mdxType:"Tabs"},(0,r.kt)(l.Z,{value:"docker",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},'mkdir .mvnrepo\ndocker run -v ${PWD}:/mnt/project -v ${PWD}/.mvnrepo:/mnt/.mvnrepo maven:3.6.0-jdk-11-slim -- mvn -f /mnt/project/pom.xml "-Dmaven.repo.local=/mnt/.mvnrepo" package\n'))),(0,r.kt)(l.Z,{value:"podman",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},'mkdir .mvnrepo\npodman run -v ${PWD}:/mnt/project -v ${PWD}/.mvnrepo:/mnt/.mvnrepo maven:3.6.0-jdk-11-slim -- mvn -f /mnt/project/pom.xml "-Dmaven.repo.local=/mnt/.mvnrepo" package\n')))),(0,r.kt)("p",null,"or you can also use maven directly if you have Java SDK and Maven installed"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"mvn package\n")),(0,r.kt)("p",null,"This creates a jar-file ./target/getting-started-1.0.jar containing the compiled Scala classes.\nThe ",(0,r.kt)("em",{parentName:"p"},"docker run")," includes a parameter to mount ./target into the docker image, which makes this jar-file accessible to SDL."),(0,r.kt)("p",null,"Now you can start SDL again:"),(0,r.kt)(i.Z,{groupId:"docker-podman-switch",defaultValue:"docker",values:[{label:"Docker",value:"docker"},{label:"Podman",value:"podman"}],mdxType:"Tabs"},(0,r.kt)(l.Z,{value:"docker",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"docker run --rm -v ${PWD}/data:/mnt/data -v ${PWD}/target:/mnt/lib -v ${PWD}/config:/mnt/config sdl-spark:latest -c /mnt/config --feed-sel compute\n"))),(0,r.kt)(l.Z,{value:"podman",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"podman run --rm -v ${PWD}/data:/mnt/data -v ${PWD}/target:/mnt/lib -v ${PWD}/config:/mnt/config sdl-spark:latest -c /mnt/config --feed-sel compute\n")))),(0,r.kt)("p",null,"Under ",(0,r.kt)("em",{parentName:"p"},"data/btl-distances")," you can now see the final result. "),(0,r.kt)("h3",{id:"the-execution-dag-of-the-compute-feed"},"The Execution DAG of the compute feed"),(0,r.kt)("p",null,"In the console, you probably started noticing some pretty ASCII Art that looks like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"                     \u250c\u2500\u2500\u2500\u2500\u2500\u2510\n                     \u2502start\u2502\n                     \u2514\u252c\u2500\u2500\u252c\u2500\u2518\n                      \u2502  \u2502\n                      \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                      v                      \u2502\n \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n \u2502select-airport-cols SUCCEEDED PT4.421793S\u2502 \u2502\n \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n                 \u2502                           \u2502\n                 v                           v\n \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n \u2502join_departures_airports SUCCEEDED PT2.938995S\u2502\n \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                        \u2502\n                        v\n   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n   \u2502compute_distances SUCCEEDED PT1.160045S\u2502\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n")),(0,r.kt)("p",null,"This is the Execution ",(0,r.kt)("em",{parentName:"p"},"DAG")," of our data pipeline.\nSDL internally builds a Directed Acyclic Graph (DAG) to analyze all dependencies between your actions.\nBecause it's acyclic, it cannot have loops, so it's impossible to define an action that depends on an output of subsequent actions.\nSDL uses this DAG to optimize execution of your pipeline as it knows in which order the pipeline needs to execute."),(0,r.kt)("p",null,"What you see in the logs, is a representation of what the SDL has determined as dependencies.\nIf you don't get the results you expect, it's good to check if the DAG looks correct.\nAt the end you will also see the graph again with status indicators (SUCCEEDED, CANCELLED, ...) and the duration it took to execute the action."),(0,r.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Hold on")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"It's worth pausing at this point to appreciate this fact:",(0,r.kt)("br",{parentName:"p"}),"\n","You didn't have to explicitly tell SDL how to execute your actions.\nYou also didn't have to define the dependencies between your actions.\nJust from the definitions of DataObjects and Actions alone, SDL builds a DAG and knows what needs to be executed and how."))),(0,r.kt)("h3",{id:"the-execution-dag-of-the--feed"},"The Execution DAG of the .* feed"),(0,r.kt)("p",null,"You can also execute the entire data pipeline by selecting all feeds:"),(0,r.kt)(i.Z,{groupId:"docker-podman-switch",defaultValue:"docker",values:[{label:"Docker",value:"docker"},{label:"Podman",value:"podman"}],mdxType:"Tabs"},(0,r.kt)(l.Z,{value:"docker",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"docker run --rm -v ${PWD}/data:/mnt/data -v ${PWD}/target:/mnt/lib -v ${PWD}/config:/mnt/config sdl-spark:latest --config /mnt/config --feed-sel .*\n"))),(0,r.kt)(l.Z,{value:"podman",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"podman run --rm -v ${PWD}/data:/mnt/data -v ${PWD}/target:/mnt/lib -v ${PWD}/config:/mnt/config sdl-spark:latest --config /mnt/config --feed-sel .*\n")))),(0,r.kt)("p",null,"The successful execution DAG looks like this"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"                                        \u250c\u2500\u2500\u2500\u2500\u2500\u2510\n                                        \u2502start\u2502\n                                        \u2514\u2500\u252c\u2500\u252c\u2500\u2518\n                                          \u2502 \u2502\n                                          \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                                          v                       \u2502\n               \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510          \u2502\n               \u2502download-airports SUCCEEDED PT8.662886S\u2502          \u2502\n               \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518          \u2502\n                      \u2502                                           \u2502\n                      v                                           v\n \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n \u2502select-airport-cols SUCCEEDED PT4.629163S\u2502 \u2502download-departures SUCCEEDED PT0.564972S\u2502\n \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                                      \n                                    v               v\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502join_departures_airports SUCCEEDED PT4.453514S\u2502\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                           \u2502\n                                           v\n                       \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                       \u2502compute_distances SUCCEEDED PT1.404391S\u2502\n                       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n")),(0,r.kt)("p",null,"SDL was able to determine that download-airports and download-departures can be executed in parallel,\nindependently from each other. It's only at join-departures-airports and beyond that both Data Sources are needed."),(0,r.kt)("p",null,"SDL has command-line option called --parallelism which allows you to set the degree of parallelism used when executing the DAG run.\nPer default, it's set to 1."),(0,r.kt)("h3",{id:"the-execution-dag-of-the-failed--feed"},"The Execution DAG of the failed .* feed"),(0,r.kt)("p",null,"If you set the option ",(0,r.kt)("em",{parentName:"p"},"readTimeoutMs=0")," in the DataObject ",(0,r.kt)("em",{parentName:"p"},"ext-departures"),"  it's possible that the ",(0,r.kt)("em",{parentName:"p"},"download-departures")," action fails.\nThat's because SDL abandons the download because the REST-Service is too slow to respond.\nIf that happens, the DAG will look like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"21/09/14 09:05:36 ERROR ActionDAGRun: Exec: TaskFailedException: Task download-departures failed. Root cause is 'WebserviceException: connect timed out': WebserviceException: connect timed out\n21/09/14 09:05:36 INFO ActionDAGRun$: Exec FAILED for .* runId=1 attemptId=1:\n                                       \u250c\u2500\u2500\u2500\u2500\u2500\u2510\n                                       \u2502start\u2502\n                                       \u2514\u2500\u252c\u2500\u252c\u2500\u2518\n                                         \u2502 \u2502\n                                         \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                                         v                       \u2502\n              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510          \u2502\n              \u2502download-airports SUCCEEDED PT6.638844S\u2502          \u2502\n              \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518          \u2502\n                      \u2502                                          \u2502\n                      v                                          v\n \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n \u2502select-airport-cols SUCCEEDED PT3.064118S\u2502 \u2502download-departures FAILED PT1.084153S\u2502\n \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                    \u2502           \u2502\n                                    v           v\n                        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                        \u2502join-departures-airports CANCELLED\u2502\n                        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                          \u2502\n                                          v\n                            \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                            \u2502compute-distances CANCELLED\u2502\n                            \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n")),(0,r.kt)("p",null,"As you can see, in this example, the action ",(0,r.kt)("em",{parentName:"p"},"download-departures")," failed because of a timeout.\nBecause SDL determined that both downloads are independent, it was able to complete ",(0,r.kt)("em",{parentName:"p"},"select-airport-cols")," succesfully."),(0,r.kt)("p",null,"As explained in ",(0,r.kt)("a",{parentName:"p",href:"/docs/getting-started/part-1/select-columns#more-on-feeds"},"a previous step of the guide"),",\nif your download fails you will have to re-execute the download feed before being able to execute\n.* again."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Congratulations!"),(0,r.kt)("br",{parentName:"p"}),"\n","You successfully recreated the configuration file that is contained in the Docker Image you ran in the first step."))}f.isMDXComponent=!0},1159:function(e,t,n){t.Z=n.p+"assets/files/application-part1-compute-final-fcc8c1494d45a8500eedd508e0245aff.conf"}}]);